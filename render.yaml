services:
  # Option 1: Backend Only (Recommended for separate deployment)
  - type: web
    name: retrocare-backend
    env: node
    buildCommand: npm install
    startCommand: npx tsx backend/server.ts
    envVars:
      - key: NODE_ENV
        value: production
    healthCheckPath: /health

  # Python Anomaly Detection Service
  - type: web
    name: retrocare-python
    env: python
    buildCommand: pip install -r requirements.txt
    startCommand: uvicorn main:app --host 0.0.0.0 --port $PORT
    rootDir: python/anomaly-service
    envVars:
      - key: PORT
        value: 8000
      - key: CORS_ORIGINS
        value: https://retrocare.onrender.com,http://localhost:3000
    healthCheckPath: /health

  # Option 2: Frontend + Backend Together (If you prefer one service)
  # Uncomment this and comment out the backend-only service above
  # - type: web
  #   name: retrocare-full
  #   env: node
  #   buildCommand: npm install && npx expo export --platform web
  #   startCommand: npx tsx backend/serverWithFrontend.ts
  #   envVars:
  #     - key: NODE_ENV
  #       value: production
  #   healthCheckPath: /health

